-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 17


-- !query 0
create temporary view t as select * from values 0, 1, 2 as t(id)
-- !query 0 schema
struct<>
-- !query 0 output



-- !query 1
create temporary view t2 as select * from values 0, 1 as t(id)
-- !query 1 schema
struct<>
-- !query 1 output



-- !query 2
SET spark.sql.legacy.ctePrecedence.enabled=true
-- !query 2 schema
struct<key:string,value:string>
-- !query 2 output
spark.sql.legacy.ctePrecedence.enabled	true


-- !query 3
WITH t as (
  WITH t2 AS (SELECT 1)
  SELECT * FROM t2
)
SELECT * FROM t
-- !query 3 schema
struct<1:int>
-- !query 3 output
1


-- !query 4
SELECT max(c) FROM (
  WITH t(c) AS (SELECT 1)
  SELECT * FROM t
)
-- !query 4 schema
struct<max(c):int>
-- !query 4 output
1


-- !query 5
SELECT (
  WITH t AS (SELECT 1)
  SELECT * FROM t
)
-- !query 5 schema
struct<scalarsubquery():int>
-- !query 5 output
1


-- !query 6
WITH
  t AS (SELECT 1),
  t2 AS (
    WITH t AS (SELECT 2)
    SELECT * FROM t
  )
SELECT * FROM t2
-- !query 6 schema
struct<1:int>
-- !query 6 output
1


-- !query 7
WITH
  t(c) AS (SELECT 1),
  t2 AS (
    SELECT (
      SELECT max(c) FROM (
        WITH t(c) AS (SELECT 2)
        SELECT * FROM t
      )
    )
  )
SELECT * FROM t2
-- !query 7 schema
struct<scalarsubquery():int>
-- !query 7 output
1


-- !query 8
WITH
  t AS (SELECT 1),
  t2 AS (
    WITH t AS (SELECT 2),
    t2 AS (
      WITH t AS (SELECT 3)
      SELECT * FROM t
    )
    SELECT * FROM t2
  )
SELECT * FROM t2
-- !query 8 schema
struct<2:int>
-- !query 8 output
2


-- !query 9
WITH t(c) AS (SELECT 1)
SELECT max(c) FROM (
  WITH t(c) AS (SELECT 2)
  SELECT * FROM t
)
-- !query 9 schema
struct<max(c):int>
-- !query 9 output
2


-- !query 10
WITH t(c) AS (SELECT 1)
SELECT sum(c) FROM (
  SELECT max(c) AS c FROM (
    WITH t(c) AS (SELECT 2)
    SELECT * FROM t
  )
)
-- !query 10 schema
struct<sum(c):bigint>
-- !query 10 output
2


-- !query 11
WITH t(c) AS (SELECT 1)
SELECT sum(c) FROM (
  WITH t(c) AS (SELECT 2)
  SELECT max(c) AS c FROM (
    WITH t(c) AS (SELECT 3)
    SELECT * FROM t
  )
)
-- !query 11 schema
struct<sum(c):bigint>
-- !query 11 output
3


-- !query 12
WITH t AS (SELECT 1)
SELECT (
  WITH t AS (SELECT 2)
  SELECT * FROM t
)
-- !query 12 schema
struct<scalarsubquery():int>
-- !query 12 output
1


-- !query 13
WITH t AS (SELECT 1)
SELECT (
  SELECT (
    WITH t AS (SELECT 2)
    SELECT * FROM t
  )
)
-- !query 13 schema
struct<scalarsubquery():int>
-- !query 13 output
1


-- !query 14
WITH t AS (SELECT 1)
SELECT (
  WITH t AS (SELECT 2)
  SELECT (
    WITH t AS (SELECT 3)
    SELECT * FROM t
  )
)
-- !query 14 schema
struct<scalarsubquery():int>
-- !query 14 output
1


-- !query 15
DROP VIEW IF EXISTS t
-- !query 15 schema
struct<>
-- !query 15 output



-- !query 16
DROP VIEW IF EXISTS t2
-- !query 16 schema
struct<>
-- !query 16 output

