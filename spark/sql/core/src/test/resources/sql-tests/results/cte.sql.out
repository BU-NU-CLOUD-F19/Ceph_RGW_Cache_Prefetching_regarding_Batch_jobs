-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 27


-- !query 0
create temporary view t as select * from values 0, 1, 2 as t(id)
-- !query 0 schema
struct<>
-- !query 0 output



-- !query 1
create temporary view t2 as select * from values 0, 1 as t(id)
-- !query 1 schema
struct<>
-- !query 1 output



-- !query 2
WITH s AS (SELECT 1 FROM s) SELECT * FROM s
-- !query 2 schema
struct<>
-- !query 2 output
org.apache.spark.sql.AnalysisException
Table or view not found: s; line 1 pos 25


-- !query 3
WITH r AS (SELECT (SELECT * FROM r))
SELECT * FROM r
-- !query 3 schema
struct<>
-- !query 3 output
org.apache.spark.sql.AnalysisException
Table or view not found: r; line 1 pos 33


-- !query 4
WITH t AS (SELECT 1 FROM t) SELECT * FROM t
-- !query 4 schema
struct<1:int>
-- !query 4 output
1
1
1


-- !query 5
WITH s1 AS (SELECT 1 FROM s2), s2 AS (SELECT 1 FROM s1) SELECT * FROM s1, s2
-- !query 5 schema
struct<>
-- !query 5 output
org.apache.spark.sql.AnalysisException
Table or view not found: s2; line 1 pos 26


-- !query 6
WITH t1 AS (SELECT * FROM t2), t2 AS (SELECT 2 FROM t1) SELECT * FROM t1 cross join t2
-- !query 6 schema
struct<id:int,2:int>
-- !query 6 output
0	2
0	2
1	2
1	2


-- !query 7
WITH CTE1 AS (
  SELECT b.id AS id
  FROM   T2 a
         CROSS JOIN (SELECT id AS id FROM T2) b
)
SELECT t1.id AS c1,
       t2.id AS c2
FROM   CTE1 t1
       CROSS JOIN CTE1 t2
-- !query 7 schema
struct<c1:int,c2:int>
-- !query 7 output
0	0
0	0
0	0
0	0
0	1
0	1
0	1
0	1
1	0
1	0
1	0
1	0
1	1
1	1
1	1
1	1


-- !query 8
WITH t(x) AS (SELECT 1)
SELECT * FROM t WHERE x = 1
-- !query 8 schema
struct<x:int>
-- !query 8 output
1


-- !query 9
WITH t(x, y) AS (SELECT 1, 2)
SELECT * FROM t WHERE x = 1 AND y = 2
-- !query 9 schema
struct<x:int,y:int>
-- !query 9 output
1	2


-- !query 10
WITH t(x, x) AS (SELECT 1, 2)
SELECT * FROM t
-- !query 10 schema
struct<x:int,x:int>
-- !query 10 output
1	2


-- !query 11
WITH t() AS (SELECT 1)
SELECT * FROM t
-- !query 11 schema
struct<>
-- !query 11 output
org.apache.spark.sql.catalyst.parser.ParseException

no viable alternative at input 'WITH t()'(line 1, pos 7)

== SQL ==
WITH t() AS (SELECT 1)
-------^^^
SELECT * FROM t


-- !query 12
WITH
  t(x) AS (SELECT 1),
  t(x) AS (SELECT 2)
SELECT * FROM t
-- !query 12 schema
struct<>
-- !query 12 output
org.apache.spark.sql.catalyst.parser.ParseException

CTE definition can't have duplicate names: 't'.(line 1, pos 0)

== SQL ==
WITH
^^^
  t(x) AS (SELECT 1),
  t(x) AS (SELECT 2)
SELECT * FROM t


-- !query 13
WITH t as (
  WITH t2 AS (SELECT 1)
  SELECT * FROM t2
)
SELECT * FROM t
-- !query 13 schema
struct<1:int>
-- !query 13 output
1


-- !query 14
SELECT max(c) FROM (
  WITH t(c) AS (SELECT 1)
  SELECT * FROM t
)
-- !query 14 schema
struct<max(c):int>
-- !query 14 output
1


-- !query 15
SELECT (
  WITH t AS (SELECT 1)
  SELECT * FROM t
)
-- !query 15 schema
struct<scalarsubquery():int>
-- !query 15 output
1


-- !query 16
WITH
  t AS (SELECT 1),
  t2 AS (
    WITH t AS (SELECT 2)
    SELECT * FROM t
  )
SELECT * FROM t2
-- !query 16 schema
struct<2:int>
-- !query 16 output
2


-- !query 17
WITH
  t(c) AS (SELECT 1),
  t2 AS (
    SELECT (
      SELECT max(c) FROM (
        WITH t(c) AS (SELECT 2)
        SELECT * FROM t
      )
    )
  )
SELECT * FROM t2
-- !query 17 schema
struct<scalarsubquery():int>
-- !query 17 output
2


-- !query 18
WITH
  t AS (SELECT 1),
  t2 AS (
    WITH t AS (SELECT 2),
    t2 AS (
      WITH t AS (SELECT 3)
      SELECT * FROM t
    )
    SELECT * FROM t2
  )
SELECT * FROM t2
-- !query 18 schema
struct<3:int>
-- !query 18 output
3


-- !query 19
WITH t(c) AS (SELECT 1)
SELECT max(c) FROM (
  WITH t(c) AS (SELECT 2)
  SELECT * FROM t
)
-- !query 19 schema
struct<max(c):int>
-- !query 19 output
2


-- !query 20
WITH t(c) AS (SELECT 1)
SELECT sum(c) FROM (
  SELECT max(c) AS c FROM (
    WITH t(c) AS (SELECT 2)
    SELECT * FROM t
  )
)
-- !query 20 schema
struct<sum(c):bigint>
-- !query 20 output
2


-- !query 21
WITH t(c) AS (SELECT 1)
SELECT sum(c) FROM (
  WITH t(c) AS (SELECT 2)
  SELECT max(c) AS c FROM (
    WITH t(c) AS (SELECT 3)
    SELECT * FROM t
  )
)
-- !query 21 schema
struct<sum(c):bigint>
-- !query 21 output
3


-- !query 22
WITH t AS (SELECT 1)
SELECT (
  WITH t AS (SELECT 2)
  SELECT * FROM t
)
-- !query 22 schema
struct<scalarsubquery():int>
-- !query 22 output
2


-- !query 23
WITH t AS (SELECT 1)
SELECT (
  SELECT (
    WITH t AS (SELECT 2)
    SELECT * FROM t
  )
)
-- !query 23 schema
struct<scalarsubquery():int>
-- !query 23 output
2


-- !query 24
WITH t AS (SELECT 1)
SELECT (
  WITH t AS (SELECT 2)
  SELECT (
    WITH t AS (SELECT 3)
    SELECT * FROM t
  )
)
-- !query 24 schema
struct<scalarsubquery():int>
-- !query 24 output
3


-- !query 25
DROP VIEW IF EXISTS t
-- !query 25 schema
struct<>
-- !query 25 output



-- !query 26
DROP VIEW IF EXISTS t2
-- !query 26 schema
struct<>
-- !query 26 output

