-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 27


-- !query 0
select bit_count(null)
-- !query 0 schema
struct<bit_count(CAST(NULL AS INT)):int>
-- !query 0 output
NULL


-- !query 1
select bit_count(true)
-- !query 1 schema
struct<bit_count(true):int>
-- !query 1 output
1


-- !query 2
select bit_count(false)
-- !query 2 schema
struct<bit_count(false):int>
-- !query 2 output
0


-- !query 3
select bit_count(cast(1 as tinyint))
-- !query 3 schema
struct<bit_count(CAST(1 AS TINYINT)):int>
-- !query 3 output
1


-- !query 4
select bit_count(cast(2 as tinyint))
-- !query 4 schema
struct<bit_count(CAST(2 AS TINYINT)):int>
-- !query 4 output
1


-- !query 5
select bit_count(cast(3 as tinyint))
-- !query 5 schema
struct<bit_count(CAST(3 AS TINYINT)):int>
-- !query 5 output
2


-- !query 6
select bit_count(1S)
-- !query 6 schema
struct<bit_count(1):int>
-- !query 6 output
1


-- !query 7
select bit_count(2S)
-- !query 7 schema
struct<bit_count(2):int>
-- !query 7 output
1


-- !query 8
select bit_count(3S)
-- !query 8 schema
struct<bit_count(3):int>
-- !query 8 output
2


-- !query 9
select bit_count(1)
-- !query 9 schema
struct<bit_count(1):int>
-- !query 9 output
1


-- !query 10
select bit_count(2)
-- !query 10 schema
struct<bit_count(2):int>
-- !query 10 output
1


-- !query 11
select bit_count(3)
-- !query 11 schema
struct<bit_count(3):int>
-- !query 11 output
2


-- !query 12
select bit_count(1L)
-- !query 12 schema
struct<bit_count(1):int>
-- !query 12 output
1


-- !query 13
select bit_count(2L)
-- !query 13 schema
struct<bit_count(2):int>
-- !query 13 output
1


-- !query 14
select bit_count(3L)
-- !query 14 schema
struct<bit_count(3):int>
-- !query 14 output
2


-- !query 15
select bit_count(-1L)
-- !query 15 schema
struct<bit_count(-1):int>
-- !query 15 output
64


-- !query 16
select bit_count(9223372036854775807L)
-- !query 16 schema
struct<bit_count(9223372036854775807):int>
-- !query 16 output
63


-- !query 17
select bit_count(-9223372036854775808L)
-- !query 17 schema
struct<bit_count(-9223372036854775808):int>
-- !query 17 output
1


-- !query 18
select bit_count("bit count")
-- !query 18 schema
struct<>
-- !query 18 output
org.apache.spark.sql.AnalysisException
cannot resolve 'bit_count('bit count')' due to data type mismatch: argument 1 requires (integral or boolean) type, however, ''bit count'' is of string type.; line 1 pos 7


-- !query 19
select bit_count('a')
-- !query 19 schema
struct<>
-- !query 19 output
org.apache.spark.sql.AnalysisException
cannot resolve 'bit_count('a')' due to data type mismatch: argument 1 requires (integral or boolean) type, however, ''a'' is of string type.; line 1 pos 7


-- !query 20
CREATE OR REPLACE TEMPORARY VIEW bitwise_test AS SELECT * FROM VALUES
  (1, 1, 1, 1L),
  (2, 3, 4, null),
  (7, 7, 7, 3L) AS bitwise_test(b1, b2, b3, b4)
-- !query 20 schema
struct<>
-- !query 20 output



-- !query 21
SELECT BIT_XOR(b3) AS n1 FROM bitwise_test where 1 = 0
-- !query 21 schema
struct<n1:int>
-- !query 21 output
NULL


-- !query 22
SELECT BIT_XOR(b4) AS n1 FROM bitwise_test where b4 is null
-- !query 22 schema
struct<n1:bigint>
-- !query 22 output
NULL


-- !query 23
SELECT
 BIT_XOR(cast(b1 as tinyint))  AS a4,
 BIT_XOR(cast(b2 as smallint))  AS b5,
 BIT_XOR(b3)  AS c2,
 BIT_XOR(b4)  AS d2,
 BIT_XOR(distinct b4) AS e2
FROM bitwise_test
-- !query 23 schema
struct<a4:tinyint,b5:smallint,c2:int,d2:bigint,e2:bigint>
-- !query 23 output
4	5	2	2	2


-- !query 24
SELECT bit_xor(b3) FROM bitwise_test GROUP BY b1 & 1
-- !query 24 schema
struct<bit_xor(b3):int>
-- !query 24 output
4
6


-- !query 25
SELECT b1, bit_xor(b2) FROM bitwise_test GROUP BY b1 HAVING bit_and(b2) < 7
-- !query 25 schema
struct<b1:int,bit_xor(b2):int>
-- !query 25 output
1	1
2	3


-- !query 26
SELECT b1, b2, bit_xor(b2) OVER (PARTITION BY b1 ORDER BY b2) FROM bitwise_test
-- !query 26 schema
struct<b1:int,b2:int,bit_xor(b2) OVER (PARTITION BY b1 ORDER BY b2 ASC NULLS FIRST RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW):int>
-- !query 26 output
1	1	1
2	3	3
7	7	7
